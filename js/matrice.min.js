function Vector(a,b,c){this.o=a;this.s=b;this.n=c}window.Vector=Vector;function logVector(a){console.log("origine: "+a.o+" sens: "+a.s+" norme: "+a.n)}window.logVector=logVector;function magnitudevertex(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2])}window.magnitudevertex=magnitudevertex;function normalisevertex(a){var b=[0,0,0],c=magnitudevertex(a);b[0]=a[0]/c;b[1]=a[1]/c;b[2]=a[2]/c;return b}window.normalisevertex=normalisevertex;
function vectorproduct(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}window.vectorproduct=vectorproduct;function scalarproduct(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}window.scalarproduct=scalarproduct;function multiplymatrix(a,b){var c=[];c.length=16;var d,e,f;for(e=0;4>e;e++)for(d=0;4>d;d++)for(f=c[d+4*e]=0;4>f;f++)c[d+4*e]+=a[f+4*e]*b[d+4*f];return c}window.multiplymatrix=multiplymatrix;
function applypersp(a){v1[0]=viewangle/a[2]*a[0];v1[1]=viewangle/a[2]*a[1];v1[2]=a[2];return v1}window.applypersp=applypersp;function applymat(a,b){var c=$.extend(!0,[],b);c[0]=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3];c[1]=a[4]*b[0]+a[5]*b[1]+a[6]*b[2]+a[7];c[2]=a[8]*b[0]+a[9]*b[1]+a[10]*b[2]+a[11];return c}window.applymat=applymat;
function applymatNpersp(a,b){var c=[];c.lenth=3;c[2]=a[8]*b[0]+a[9]*b[1]+a[10]*b[2]+a[11];c[0]=viewangle/c[2]*(a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]);c[1]=viewangle/c[2]*(a[4]*b[0]+a[5]*b[1]+a[6]*b[2]+a[7]);return c}window.applymatNpersp=applymatNpersp;function genimat(){var a=[];a.length=16;var b,c;for(b=0;4>b;b++)for(c=0;4>c;c++)a[b+4*c]=b==c?1:0;return a}window.genimat=genimat;function gentmat(a,b,c){var d=genimat();d[3]=a;d[7]=b;d[11]=c;return d}window.gentmat=gentmat;
function genrmat(a,b,c){a*=Math.PI/180;var d=Math.PI/180*b,e=Math.PI/180*c;c=genimat();b=Math.cos(a);a=Math.sin(a);var f=Math.cos(d);d=Math.sin(d);var g=Math.cos(e);e=Math.sin(e);var h=b*d,k=a*d;c[0]=f*g;c[1]=-f*e;c[2]=-d;c[4]=-k*g+b*e;c[5]=k*e+b*g;c[6]=-a*f;c[8]=h*g+a*e;c[9]=-h*e+a*g;c[10]=b*f;c[3]=c[7]=c[11]=c[12]=c[13]=c[14]=0;c[15]=1;return c}window.genrmat=genrmat;
function vectfromvertices(a,b){var c=Math.sqrt((b[0]-a[0])*(b[0]-a[0])+(b[1]-a[1])*(b[1]-a[1])+(b[2]-a[2])*(b[2]-a[2]));return new Vector(a,[(b[0]-a[0])/c,(b[1]-a[1])/c,(b[2]-a[2])/c],c)}window.vectfromvertices=vectfromvertices;
function axe_ang_to_mat(a,b){var c=genimat(),d=Math.cos(b),e=Math.sin(b);c[0]=d+a[0]*a[0]*(1-d);c[4]=a[2]*e+a[1]*a[0]*(1-d);c[8]=-a[1]*e+a[2]*a[0]*(1-d);c[1]=-a[2]*e+a[0]*a[1]*(1-d);c[5]=d+a[1]*a[1]*(1-d);c[9]=a[0]*e+a[2]*a[1]*(1-d);c[2]=a[1]*e+a[0]*a[2]*(1-d);c[6]=-a[0]*e+a[1]*a[2]*(1-d);c[10]=d+a[2]*a[2]*(1-d);c[3]=c[7]=c[11]=c[12]=c[13]=c[14]=0;c[15]=1;return c}function geninterpmat(a,b){axe_ang_to_mat(vectorproduct(a,b),scalarproduct(a,b))}window.geninterpmat=geninterpmat;
function matrixinverse(a){var b=genimat();b[0]=a[5]*a[10]*a[15]-a[5]*a[14]*a[11]-a[6]*a[9]*a[15]+a[6]*a[13]*a[11]+a[7]*a[9]*a[14]-a[7]*a[13]*a[10];b[1]=-a[1]*a[10]*a[15]+a[1]*a[14]*a[11]+a[2]*a[9]*a[15]-a[2]*a[13]*a[11]-a[3]*a[9]*a[14]+a[3]*a[13]*a[10];b[2]=a[1]*a[6]*a[15]-a[1]*a[14]*a[7]-a[2]*a[5]*a[15]+a[2]*a[13]*a[7]+a[3]*a[5]*a[14]-a[3]*a[13]*a[6];b[3]=-a[1]*a[6]*a[11]+a[1]*a[10]*a[7]+a[2]*a[5]*a[11]-a[2]*a[9]*a[7]-a[3]*a[5]*a[10]+a[3]*a[9]*a[6];b[4]=-a[4]*a[10]*a[15]+a[4]*a[14]*a[11]+a[6]*a[8]*
a[15]-a[6]*a[12]*a[11]-a[7]*a[8]*a[14]+a[7]*a[12]*a[10];b[5]=a[0]*a[10]*a[15]-a[0]*a[14]*a[11]-a[2]*a[8]*a[15]+a[2]*a[12]*a[11]+a[3]*a[8]*a[14]-a[3]*a[12]*a[10];b[6]=-a[0]*a[6]*a[15]+a[0]*a[14]*a[7]+a[2]*a[4]*a[15]-a[2]*a[12]*a[7]-a[3]*a[4]*a[14]+a[3]*a[12]*a[6];b[7]=a[0]*a[6]*a[11]-a[0]*a[10]*a[7]-a[2]*a[4]*a[11]+a[2]*a[8]*a[7]+a[3]*a[4]*a[10]-a[3]*a[8]*a[6];b[8]=a[4]*a[9]*a[15]-a[4]*a[13]*a[11]-a[5]*a[8]*a[15]+a[5]*a[12]*a[11]+a[7]*a[8]*a[13]-a[7]*a[12]*a[9];b[9]=-a[0]*a[9]*a[15]+a[0]*a[13]*a[11]+
a[1]*a[8]*a[15]-a[1]*a[12]*a[11]-a[3]*a[8]*a[13]+a[3]*a[12]*a[9];b[10]=a[0]*a[5]*a[15]-a[0]*a[13]*a[7]-a[1]*a[4]*a[15]+a[1]*a[12]*a[7]+a[3]*a[4]*a[13]-a[3]*a[12]*a[5];b[11]=-a[0]*a[5]*a[11]+a[0]*a[9]*a[7]+a[1]*a[4]*a[11]-a[1]*a[8]*a[7]-a[3]*a[4]*a[9]+a[3]*a[8]*a[5];b[12]=-a[4]*a[9]*a[14]+a[4]*a[13]*a[10]+a[5]*a[8]*a[14]-a[5]*a[12]*a[10]-a[6]*a[8]*a[13]+a[6]*a[12]*a[9];b[13]=a[0]*a[9]*a[14]-a[0]*a[13]*a[10]-a[1]*a[8]*a[14]+a[1]*a[12]*a[10]+a[2]*a[8]*a[13]-a[2]*a[12]*a[9];b[14]=-a[0]*a[5]*a[14]+a[0]*
a[13]*a[6]+a[1]*a[4]*a[14]-a[1]*a[12]*a[6]-a[2]*a[4]*a[13]+a[2]*a[12]*a[5];b[15]=a[0]*a[5]*a[10]-a[0]*a[9]*a[6]-a[1]*a[4]*a[10]+a[1]*a[8]*a[6]+a[2]*a[4]*a[9]-a[2]*a[8]*a[5];a=a[0]*b[0]+a[1]*b[4]+a[2]*b[8]+a[3]*b[12];for(var c=0;16>c;c++)b[c]/=a;return b}window.matrixinverse=matrixinverse;
